<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Poppy的个人主页</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
</head>
<body class="font-sans bg-gray-50 text-gray-800">
  <header class="fixed top-0 left-0 right-0 bg-white shadow-md z-50">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center">
        <i class="fa fa-line-chart text-primary text-xl"></i>
        <h1 class="text-xl font-bold ml-2">数据看板</h1>
      </div>
      <nav class="hidden md:flex space-x-6">
        <a href="#items" class="text-gray-600 hover:text-primary">个人物品</a>
        <a href="#relations" class="text-gray-600 hover:text-primary">网络关系</a>
        <a href="#moods" class="text-gray-600 hover:text-primary">心情记录</a>
      </nav>
      <button id="mobile-menu-button" class="md:hidden">
        <i class="fa fa-bars text-xl"></i>
      </button>
    </div>
    <div id="mobile-menu" class="md:hidden hidden bg-white shadow-lg">
      <div class="container mx-auto px-4 py-3 flex flex-col space-y-4">
        <a href="#items" class="text-gray-600 hover:text-primary py-2">个人物品</a>
        <a href="#relations" class="text-gray-600 hover:text-primary py-2">网络关系</a>
        <a href="#moods" class="text-gray-600 hover:text-primary py-2">心情记录</a>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 pt-24 pb-16">
    <section id="items" class="mb-12">
      <div class="bg-white rounded-lg p-6 shadow-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold">个人物品</h3>
          <button id="add-item-btn" class="bg-primary text-white px-4 py-2 rounded">添加物品</button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">名称</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">场景</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
              </tr>
            </thead>
            <tbody id="items-table-body">
              <tr class="text-center">
                <td colspan="5" class="px-6 py-12 text-gray-500">暂无物品数据</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="relations" class="mb-12">
      <div class="bg-white rounded-lg p-6 shadow-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold">网络关系</h3>
          <button id="add-relation-btn" class="bg-blue-500 text-white px-4 py-2 rounded">添加关系</button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">名称</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">平台</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">关系类型</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">互动频率</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
              </tr>
            </thead>
            <tbody id="relations-table-body">
              <tr class="text-center">
                <td colspan="5" class="px-6 py-12 text-gray-500">暂无关系数据</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="moods" class="mb-12">
      <div class="bg-white rounded-lg p-6 shadow-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold">心情记录</h3>
          <button id="add-mood-btn" class="bg-purple-500 text-white px-4 py-2 rounded">记录心情</button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">日期</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">心情状态</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">描述</th>
                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
              </tr>
            </thead>
            <tbody id="moods-table-body">
              <tr class="text-center">
                <td colspan="4" class="px-6 py-12 text-gray-500">暂无心情记录</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-white border-t border-gray-200 py-6">
    <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
      <p>© 2025 数据看板. 保留所有权利.</p>
    </div>
  </footer>

  <div id="add-item-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg max-w-md w-full mx-4 p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">添加新物品</h3>
        <button id="close-item-modal" class="text-gray-400 hover:text-gray-600">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <form id="add-item-form">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="item-name">名称</label>
          <input type="text" id="item-name" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="item-scene">场景</label>
          <select id="item-scene" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary">
            <option value="wardrobe">衣橱</option>
            <option value="bedroom">卧室</option>
            <option value="living">客厅</option>
            <option value="kitchen">厨房</option>
            <option value="bathroom">浴室</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="item-quantity">数量</label>
          <input type="number" id="item-quantity" min="1" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary" value="1">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="item-status">状态</label>
          <select id="item-status" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary">
            <option value="可用">可用</option>
            <option value="已使用">已使用</option>
            <option value="闲置">闲置</option>
            <option value="维修中">维修中</option>
          </select>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" id="cancel-item-btn" class="px-4 py-2 border border-gray-300 rounded hover:bg-gray-50">取消</button>
          <button type="submit" class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90">保存</button>
        </div>
      </form>
    </div>
  </div>

  <div id="add-relation-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg max-w-md w-full mx-4 p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">添加新关系</h3>
        <button id="close-relation-modal" class="text-gray-400 hover:text-gray-600">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <form id="add-relation-form">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="relation-name">名称</label>
          <input type="text" id="relation-name" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="relation-platform">平台</label>
          <select id="relation-platform" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="微信">微信</option>
            <option value="微博">微博</option>
            <option value="QQ">QQ</option>
            <option value="LinkedIn">LinkedIn</option>
            <option value="其他">其他</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="relation-type">关系类型</label>
          <select id="relation-type" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="朋友">朋友</option>
            <option value="家人">家人</option>
            <option value="同事">同事</option>
            <option value="同学">同学</option>
            <option value="合作伙伴">合作伙伴</option>
            <option value="其他">其他</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="relation-frequency">互动频率</label>
          <select id="relation-frequency" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="每天">每天</option>
            <option value="每周">每周</option>
            <option value="每月">每月</option>
            <option value="每季度">每季度</option>
            <option value="每年">每年</option>
            <option value="很少">很少</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="relation-note">备注</label>
          <textarea id="relation-note" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" id="cancel-relation-btn" class="px-4 py-2 border border-gray-300 rounded hover:bg-gray-50">取消</button>
          <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">保存</button>
        </div>
      </form>
    </div>
  </div>

  <div id="add-mood-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg max-w-md w-full mx-4 p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">记录心情</h3>
        <button id="close-mood-modal" class="text-gray-400 hover:text-gray-600">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <form id="add-mood-form">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="mood-date">日期</label>
          <input type="date" id="mood-date" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">心情状态</label>
          <div class="grid grid-cols-5 gap-2">
            <div class="mood-option cursor-pointer p-2 rounded-lg text-center border-2 border-gray-200" data-value="非常开心">
              <i class="fa fa-smile-o text-2xl text-yellow-400"></i>
              <p class="text-xs mt-1">非常开心</p>
            </div>
            <div class="mood-option cursor-pointer p-2 rounded-lg text-center border-2 border-gray-200" data-value="开心">
              <i class="fa fa-smile-o text-2xl text-yellow-300"></i>
              <p class="text-xs mt-1">开心</p>
            </div>
            <div class="mood-option cursor-pointer p-2 rounded-lg text-center border-2 border-gray-200" data-value="一般">
              <i class="fa fa-meh-o text-2xl text-gray-400"></i>
              <p class="text-xs mt-1">一般</p>
            </div>
            <div class="mood-option cursor-pointer p-2 rounded-lg text-center border-2 border-gray-200" data-value="难过">
              <i class="fa fa-frown-o text-2xl text-blue-400"></i>
              <p class="text-xs mt-1">难过</p>
            </div>
            <div class="mood-option cursor-pointer p-2 rounded-lg text-center border-2 border-gray-200" data-value="非常难过">
              <i class="fa fa-frown-o text-2xl text-blue-500"></i>
              <p class="text-xs mt-1">非常难过</p>
            </div>
          </div>
          <input type="hidden" id="mood-value" value="">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1" for="mood-description">描述</label>
          <textarea id="mood-description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-purple-500"></textarea>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" id="cancel-mood-btn" class="px-4 py-2 border border-gray-300 rounded hover:bg-gray-50">取消</button>
          <button type="submit" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">保存</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // 数据存储和管理
    const DataManager = {
      loadData() {
        try {
          const items = localStorage.getItem('itemsData');
          const relations = localStorage.getItem('relationsData');
          const moods = localStorage.getItem('moodsData');
          
          return {
            items: items ? JSON.parse(items) : [],
            relations: relations ? JSON.parse(relations) : [],
            moods: moods ? JSON.parse(moods) : []
          };
        } catch (error) {
          return { items: [], relations: [], moods: [] };
        }
      },
      
      saveData(data) {
        try {
          localStorage.setItem('itemsData', JSON.stringify(data.items));
          localStorage.setItem('relationsData', JSON.stringify(data.relations));
          localStorage.setItem('moodsData', JSON.stringify(data.moods));
        } catch (error) {
          console.error('保存数据失败:', error);
        }
      }
    };
    
    // 初始化数据
    const loadedData = DataManager.loadData();
    let itemsData = loadedData.items;
    let relationsData = loadedData.relations;
    let moodsData = loadedData.moods;
    
    // DOM元素
    const modals = {
      item: {
        modal: document.getElementById('add-item-modal'),
        form: document.getElementById('add-item-form'),
        closeBtn: document.getElementById('close-item-modal'),
        cancelBtn: document.getElementById('cancel-item-btn')
      },
      relation: {
        modal: document.getElementById('add-relation-modal'),
        form: document.getElementById('add-relation-form'),
        closeBtn: document.getElementById('close-relation-modal'),
        cancelBtn: document.getElementById('cancel-relation-btn')
      },
      mood: {
        modal: document.getElementById('add-mood-modal'),
        form: document.getElementById('add-mood-form'),
        closeBtn: document.getElementById('close-mood-modal'),
        cancelBtn: document.getElementById('cancel-mood-btn')
      }
    };
    
    const tables = {
      items: document.getElementById('items-table-body'),
      relations: document.getElementById('relations-table-body'),
      moods: document.getElementById('moods-table-body')
    };
    
    // 模态框控制函数
    function openModal(modalType) {
      modals[modalType].modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
      
      if (modalType === 'mood') {
        document.getElementById('mood-date').valueAsDate = new Date();
      }
    }
    
    function closeModal(modalType) {
      modals[modalType].modal.classList.add('hidden');
      document.body.style.overflow = '';
      modals[modalType].form.reset();
      
      if (modalType === 'mood') {
        document.querySelectorAll('.mood-option').forEach(option => {
          option.classList.remove('border-purple-500', 'bg-purple-50');
        });
        document.getElementById('mood-value').value = '';
      }
    }
    
    // 添加事件监听器
    document.addEventListener('DOMContentLoaded', function() {
      // 移动端菜单切换
      document.getElementById('mobile-menu-button').addEventListener('click', function() {
        document.getElementById('mobile-menu').classList.toggle('hidden');
      });
      
      // 初始化数据显示
      updateItemsTable();
      updateRelationsTable();
      updateMoodsTable();
      
      // 修复：将事件监听器移至DOM加载完成后
      document.getElementById('add-item-btn').addEventListener('click', () => openModal('item'));
      document.getElementById('add-relation-btn').addEventListener('click', () => openModal('relation'));
      document.getElementById('add-mood-btn').addEventListener('click', () => openModal('mood'));
      
      modals.item.closeBtn.addEventListener('click', () => closeModal('item'));
      modals.item.cancelBtn.addEventListener('click', () => closeModal('item'));
      
      modals.relation.closeBtn.addEventListener('click', () => closeModal('relation'));
      modals.relation.cancelBtn.addEventListener('click', () => closeModal('relation'));
      
      modals.mood.closeBtn.addEventListener('click', () => closeModal('mood'));
      modals.mood.cancelBtn.addEventListener('click', () => closeModal('mood'));
      
      // 心情选择事件
      document.querySelectorAll('.mood-option').forEach(option => {
        option.addEventListener('click', () => {
          document.querySelectorAll('.mood-option').forEach(opt => {
            opt.classList.remove('border-purple-500', 'bg-purple-50');
          });
          option.classList.add('border-purple-500', 'bg-purple-50');
          document.getElementById('mood-value').value = option.getAttribute('data-value');
        });
      });
      
      // 添加物品表单提交
      document.getElementById('add-item-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('item-name').value;
        const scene = document.getElementById('item-scene').value;
        const quantity = parseInt(document.getElementById('item-quantity').value);
        const status = document.getElementById('item-status').value;
        
        if (!name) {
          alert('请输入物品名称');
          return;
        }
        
        const newItem = {
          id: Date.now(),
          name,
          scene,
          quantity,
          status,
          createdAt: new Date().toISOString()
        };
        
        itemsData.push(newItem);
        DataManager.saveData({ items: itemsData, relations: relationsData, moods: moodsData });
        updateItemsTable();
        closeModal('item');
      });
      
      // 添加关系表单提交
      document.getElementById('add-relation-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('relation-name').value;
        const platform = document.getElementById('relation-platform').value;
        const type = document.getElementById('relation-type').value;
        const frequency = document.getElementById('relation-frequency').value;
        const note = document.getElementById('relation-note').value;
        
        if (!name) {
          alert('请输入名称');
          return;
        }
        
        const newRelation = {
          id: Date.now(),
          name,
          platform,
          type,
          frequency,
          note,
          createdAt: new Date().toISOString()
        };
        
        relationsData.push(newRelation);
        DataManager.saveData({ items: itemsData, relations: relationsData, moods: moodsData });
        updateRelationsTable();
        closeModal('relation');
      });
      
      // 添加心情表单提交
      document.getElementById('add-mood-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const date = document.getElementById('mood-date').value;
        const value = document.getElementById('mood-value').value;
        const description = document.getElementById('mood-description').value;
        
        if (!date) {
          alert('请选择日期');
          return;
        }
        
        if (!value) {
          alert('请选择心情状态');
          return;
        }
        
        const newMood = {
          id: Date.now(),
          date,
          value,
          description,
          createdAt: new Date().toISOString()
        };
        
        moodsData.push(newMood);
        DataManager.saveData({ items: itemsData, relations: relationsData, moods: moodsData });
        updateMoodsTable();
        closeModal('mood');
      });
    });
    
    // 更新物品表格
    function updateItemsTable() {
      if (itemsData.length === 0) {
        tables.items.innerHTML = `
          <tr class="text-center">
            <td colspan="5" class="px-6 py-12 text-gray-500">暂无物品数据</td>
          </tr>
        `;
        return;
      }
      
      tables.items.innerHTML = '';
      
      itemsData.forEach(item => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-6 py-4">${item.name}</td>
          <td class="px-6 py-4">${item.scene}</td>
          <td class="px-6 py-4">${item.quantity}</td>
          <td class="px-6 py-4">${item.status}</td>
          <td class="px-6 py-4">
            <button class="text-red-500 hover:text-red-700" onclick="deleteItem(${item.id})">
              <i class="fa fa-trash"></i> 删除
            </button>
          </td>
        `;
        tables.items.appendChild(row);
      });
    }
    
    // 更新关系表格
    function updateRelationsTable() {
      if (relationsData.length === 0) {
        tables.relations.innerHTML = `
          <tr class="text-center">
            <td colspan="5" class="px-6 py-12 text-gray-500">暂无关系数据</td>
          </tr>
        `;
        return;
      }
      
      tables.relations.innerHTML = '';
      
      relationsData.forEach(relation => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-6 py-4">${relation.name}</td>
          <td class="px-6 py-4">${relation.platform}</td>
          <td class="px-6 py-4">${relation.type}</td>
          <td class="px-6 py-4">${relation.frequency}</td>
          <td class="px-6 py-4">
            <button class="text-red-500 hover:text-red-700" onclick="deleteRelation(${relation.id})">
              <i class="fa fa-trash"></i> 删除
            </button>
          </td>
        `;
        tables.relations.appendChild(row);
      });
    }
    
    // 更新心情表格
    function updateMoodsTable() {
      if (moodsData.length === 0) {
        tables.moods.innerHTML = `
          <tr class="text-center">
            <td colspan="4" class="px-6 py-12 text-gray-500">暂无心情记录</td>
          </tr>
        `;
        return;
      }
      
      tables.moods.innerHTML = '';
      
      // 按日期排序
      const sortedMoods = [...moodsData].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedMoods.forEach(mood => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-6 py-4">${formatDate(mood.date)}</td>
          <td class="px-6 py-4">${mood.value}</td>
          <td class="px-6 py-4">${mood.description}</td>
          <td class="px-6 py-4">
            <button class="text-red-500 hover:text-red-700" onclick="deleteMood(${mood.id})">
              <i class="fa fa-trash"></i> 删除
            </button>
          </td>
        `;
        tables.moods.appendChild(row);
      });
    }
    
    // 辅助函数
    function formatDate(dateString) {
      const date = new Date(dateString);
      return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
    }
    
    // 删除函数
    function deleteItem(id) {
      itemsData = itemsData.filter(item => item.id !== id);
      DataManager.saveData({ items: itemsData, relations: relationsData, moods: moodsData });
      updateItemsTable();
    }
    
    function deleteRelation(id) {
      relationsData = relationsData.filter(relation => relation.id !== id);
      DataManager.saveData({ items: itemsData, relations: relationsData, moods: moodsData });
      updateRelationsTable();
    }
    
    function deleteMood(id) {
      moodsData = moodsData.filter(mood => mood.id !== id);
      DataManager.saveData({ items: itemsData, relations: relationsData, moods: moodsData });
      updateMoodsTable();
    }
  </script>
</body>
</html>
